(function(t){function e(e){for(var n,s,o=e[0],r=e[1],u=e[2],p=0,b=[];p<o.length;p++)s=o[p],Object.prototype.hasOwnProperty.call(c,s)&&c[s]&&b.push(c[s][0]),c[s]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);l&&l(e);while(b.length)b.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,o=1;o<a.length;o++){var r=a[o];0!==c[r]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},c={app:0},i=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/box-pusher/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=r;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"396f":function(t,e,a){"use strict";a("d319")},"3c2e":function(t,e,a){"use strict";a("493c")},"493c":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("7a23"),c=(a("d81d"),{class:"container"});function i(t,e,a,i,s,o){var r=Object(n["n"])("BoxPusher"),u=Object(n["n"])("MapEditor");return Object(n["j"])(),Object(n["e"])("div",c,["default"==s.status?(Object(n["j"])(),Object(n["c"])(r,{key:0,ref:"stage",onChangestatus:o.changestatus,fmap:t.map,fstage:t.stage},null,8,["onChangestatus","fmap","fstage"])):Object(n["d"])("",!0),"edit"==s.status?(Object(n["j"])(),Object(n["c"])(u,{key:1,onChangestatus:o.changestatus,onPlay:o.play},null,8,["onChangestatus","onPlay"])):Object(n["d"])("",!0)])}var s={class:"container"},o={class:"menu"},r=Object(n["h"])("Import maps "),u={class:"stage"},l={class:"win"};function p(t,e,a,c,i,p){return Object(n["j"])(),Object(n["e"])("div",s,[Object(n["f"])("div",o,[Object(n["f"])("nav",{class:"navbtn",onClick:e[0]||(e[0]=function(){return p.changestatus&&p.changestatus.apply(p,arguments)}),"data-key":"default"},"Play"),Object(n["f"])("nav",{class:"navbtn",onClick:e[1]||(e[1]=function(){return p.changestatus&&p.changestatus.apply(p,arguments)}),"data-key":"edit"},"Edit map by yourself"),Object(n["f"])("nav",{class:"navbtn",onClick:e[3]||(e[3]=function(){return p.importmap&&p.importmap.apply(p,arguments)})},[r,Object(n["q"])(Object(n["f"])("input",{type:"file",id:"upload",onChange:e[2]||(e[2]=function(){return p.uploaded&&p.uploaded.apply(p,arguments)})},null,544),[[n["p"],!1]])]),Object(n["f"])("nav",{class:"navbtn",onClick:e[4]||(e[4]=function(){return p.share&&p.share.apply(p,arguments)})},"Share Box-pusher!")]),Object(n["f"])("div",u,[Object(n["q"])(Object(n["f"])("div",l,null,512),[[n["p"],i.show]]),(Object(n["j"])(!0),Object(n["e"])(n["a"],null,Object(n["m"])(i.active_map,(function(t,e){return Object(n["j"])(),Object(n["e"])("div",{class:"row",key:e},[(Object(n["j"])(!0),Object(n["e"])(n["a"],null,Object(n["m"])(t,(function(t,e){return Object(n["j"])(),Object(n["e"])("div",{class:Object(n["i"])(["block",p.getBlock(t)]),key:e},null,2)})),128))])})),128))])])}var b=a("53ca"),f=a("3835"),d=(a("fb6a"),a("d3b7"),a("5cc6"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),{name:"BoxPusher",props:{fmap:{type:Array,default:function(){return[0,0,0,0,0,0,0,2,1,1,1,0,0,1,3,3,1,0,0,1,1,0,0,0,0,1,1,1,4,0,0,1,1,1,4,0,0,0,0,0,0,0]}},fstage:{type:Array,default:function(){return[6,7]}}},data:function(){return{static_map:[],active_map:[],key2direction:{87:1,38:1,83:2,40:2,65:3,37:3,68:4,39:4},key_arr:[87,38,83,40,65,37,68,39],show:!1}},beforeCreate:function(){var t=this;window.onkeydown=function(e){t.move(e.keyCode)}},created:function(){this.map=v(this.fmap),this.stage=v(this.fstage),this.map_init()},mounted:function(){},computed:{player_position:function(){for(var t in this.active_map)for(var e in this.active_map[t])if(2===this.active_map[t][e])return[this.static_map[t][e],+t,+e];return[0,0]},complete_count:function(){var t=0;for(var e in this.active_map)for(var a in this.active_map[e])3===this.active_map[e][a]&&4===this.static_map[e][a]&&t++;return t}},methods:{map_init:function(){this.map.length!=this.stage[0]*this.stage[1]&&alert("map data error");for(var t=[],e=0;e<this.stage[1];e++)t.push(this.map.slice(e*this.stage[0],(e+1)*this.stage[0]));this.static_map=v(t),this.active_map=v(t),this.box_count=this.calc_block(3)},importmap:function(){document.getElementById("upload").click()},uploaded:function(t){var e=this,a=t.target.files,n=a[0],c=new FileReader;c.onload=function(t){var a=new Uint8Array(t.target.result),n=new TextDecoder("gb2312").decode(a),c=JSON.parse(n);e.map=c.map,e.stage=c.stage,e.map_init()},c.readAsArrayBuffer(n)},share:function(){alert("Functions is coming! Thanks so much!")},changestatus:function(t){this.$emit("changestatus",t)},congratulations:function(){this.show=!0},calc_block:function(t){var e=0;for(var a in this.map)this.map[a]===t&&e++;return e},getNextblock:function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return 1==t?[this.active_map[e-n][a],e-n,a]:2==t?[this.active_map[e+n][a],e+n,a]:3==t?[this.active_map[e][a-n],e,a-n]:4==t?[this.active_map[e][a+n],e,a+n]:void 0},move:function(t){var e=this.key_arr.indexOf(t);if(-1!=e){var a=this.key2direction[""+t],n=Object(f["a"])(this.player_position,3),c=n[0],i=n[1],s=n[2],o=this.getNextblock(a,i,s),r=Object(f["a"])(o,3),u=r[0],l=r[1],p=r[2];switch(u){case 4:case 1:this.active_map[l][p]=2,this.active_map[i][s]=4==c?4:1;break;case 3:var b=this.getNextblock(a,i,s,2),d=Object(f["a"])(b,3),v=d[0],h=d[1],m=d[2];[1,4].indexOf(v)>-1&&(this.active_map[h][m]=3,this.active_map[l][p]=2,this.active_map[i][s]=4==c?4:1);break}this.complete_count==this.box_count&&this.congratulations()}},getBlock:function(t){return["stone","back","player","box","dream","complete"][t]}}});function v(t){var e=Array.isArray(t)?[]:{};if(t&&"object"===Object(b["a"])(t))for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t&&"object"===Object(b["a"])(t[a])?v(t[a]):t[a]);return e}a("396f");var h=a("d959"),m=a.n(h);const j=m()(d,[["render",p],["__scopeId","data-v-e13ec61c"]]);var O=j,y=function(t){return Object(n["l"])("data-v-4e9a0265"),t=t(),Object(n["k"])(),t},g={class:"container"},k={class:"menu"},_={class:"stage"},w={class:"para"},x=y((function(){return Object(n["f"])("label",{for:"x"},"row block：",-1)})),C={class:"para"},P=y((function(){return Object(n["f"])("label",{for:"y"},"column block：",-1)})),B={class:"para"},q=y((function(){return Object(n["f"])("label",{for:"count"},"box counts：",-1)})),A={key:0,class:"editable"},E={class:"map"},S=["onClick"],U=Object(n["g"])('<div class="tips" data-v-4e9a0265> 1. Clicking at the block or pressing the keybroad with &quot;w,s,a,d&quot; to select editable block. <br data-v-4e9a0265> 2.Inputing numbers with the keys &quot;0-4&quot; to change the block function status. <br data-v-4e9a0265> 3.The box-counts must be equal to that before setting. </div><div class="iconlist" data-v-4e9a0265><div class="block stone" data-v-4e9a0265></div><div class="block back" data-v-4e9a0265></div><div class="block box" data-v-4e9a0265></div><div class="block player" data-v-4e9a0265></div><div class="block dream" data-v-4e9a0265></div></div><div class="iconlist" data-v-4e9a0265><div class="block" data-v-4e9a0265>0</div><div class="block" data-v-4e9a0265>1</div><div class="block" data-v-4e9a0265>2</div><div class="block" data-v-4e9a0265>3</div><div class="block" data-v-4e9a0265>4</div></div>',3);function M(t,e,a,c,i,s){return Object(n["j"])(),Object(n["e"])("div",g,[Object(n["f"])("div",k,[Object(n["f"])("nav",{class:"navbtn",onClick:e[0]||(e[0]=function(){return s.changestatus&&s.changestatus.apply(s,arguments)}),"data-key":"default"},"Return"),i.show?(Object(n["j"])(),Object(n["e"])("nav",{key:0,class:"navbtn",onClick:e[1]||(e[1]=function(t){return i.show=!1})},"Reset init data")):Object(n["d"])("",!0),i.show?(Object(n["j"])(),Object(n["e"])("nav",{key:1,class:"navbtn",onClick:e[2]||(e[2]=function(){return s.save&&s.save.apply(s,arguments)})},"Save & Output your map")):Object(n["d"])("",!0),i.show?(Object(n["j"])(),Object(n["e"])("nav",{key:2,class:"navbtn",onClick:e[3]||(e[3]=function(){return s.playnow&&s.playnow.apply(s,arguments)})},"Play it right now")):Object(n["d"])("",!0)]),Object(n["f"])("div",_,[Object(n["q"])(Object(n["f"])("div",null,[Object(n["f"])("div",w,[x,Object(n["q"])(Object(n["f"])("input",{type:"number",id:"x","onUpdate:modelValue":e[4]||(e[4]=function(t){return i.stage[0]=t})},null,512),[[n["o"],i.stage[0]]])]),Object(n["f"])("div",C,[P,Object(n["q"])(Object(n["f"])("input",{type:"number",id:"y","onUpdate:modelValue":e[5]||(e[5]=function(t){return i.stage[1]=t})},null,512),[[n["o"],i.stage[1]]])]),Object(n["f"])("div",B,[q,Object(n["q"])(Object(n["f"])("input",{type:"number",id:"count","onUpdate:modelValue":e[6]||(e[6]=function(t){return i.box_count=t})},null,512),[[n["o"],i.box_count]])]),Object(n["f"])("button",{class:"initbtn",onClick:e[7]||(e[7]=function(){return s.init&&s.init.apply(s,arguments)})},"Init my map")],512),[[n["p"],!i.show]]),i.show?(Object(n["j"])(),Object(n["e"])("div",A,[Object(n["f"])("div",E,[(Object(n["j"])(!0),Object(n["e"])(n["a"],null,Object(n["m"])(i.static_map,(function(t,e){return Object(n["j"])(),Object(n["e"])("div",{class:"row",key:e},[(Object(n["j"])(!0),Object(n["e"])(n["a"],null,Object(n["m"])(t,(function(t,a){return Object(n["j"])(),Object(n["e"])("div",{class:Object(n["i"])(["block",s.getBlock(t),a==i.active_position[0]&&e==i.active_position[1]?"active":""]),key:a,onClick:function(t){return i.active_position=[a,e]}},null,10,S)})),128))])})),128))]),U])):Object(n["d"])("",!0)])])}var R=a("2909"),I=(a("e9c4"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("caad"),a("2532"),a("99af"),a("cb29"),{name:"MapEditor",data:function(){return{static_map:[],stage:[6,7],box_count:2,keys:{87:1,38:1,83:2,40:2,65:3,37:3,68:4,39:4,48:0,96:0,97:-1,49:-1,98:-2,50:-2,99:-3,51:-3,100:-4,52:-4},key_arr:[87,38,83,40,65,37,68,39,49,50,51,52,53,96,97,98,99,100,48,96],active_position:[1,1],show:!1}},beforeCreate:function(){},created:function(){var t=this;window.onkeydown=function(e){t.keypress(e.keyCode)}},mounted:function(){},computed:{},methods:{changestatus:function(t){this.$emit("changestatus",t)},playnow:function(){this.singlecheckmap()&&this.$emit("play",{map:this.getstaticmap(),stage:Object(R["a"])(this.stage)})},save:function(){var t={map:this.getstaticmap(),stage:Object(R["a"])(this.stage)};if(this.singlecheckmap()){var e=document.createElement("a"),a=new Blob([JSON.stringify(t)]);e.download="box-pusher.map.json",e.href=URL.createObjectURL(a),e.click(),URL.revokeObjectURL(a),e=null}},singlecheckmap:function(){var t=0,e=0,a=this.getstaticmap();for(var n in a)3===a[n]&&(t+=1),4===a[n]&&(e+=1);return t!==this.box_count?(alert("Error:box_count incorrect!"),!1):e!==this.box_count?(alert("Error:flag_count incorrect!"),!1):!!a.includes(2)||(alert("Error:no player.Keypress 2 to set player!"),!1)},getstaticmap:function(){var t;return(t=[]).concat.apply(t,Object(R["a"])(this.static_map))},init:function(){for(var t=Object(f["a"])(this.stage,2),e=t[0],a=t[1],n=[],c=0;c<a;c++)if(0==c||c==a-1)n.push(new Array(e).fill(0));else{var i=new Array(e).fill(1);i[0]=0,i[e-1]=0,n.push(i)}this.static_map=n,this.show=!0},keypress:function(t){if(this.show){var e=this.key_arr.indexOf(t);if(-1!=e){var a=this.keys[""+t];if("undefined"!=a)switch(a){case 1:this.active_position[1]>0&&this.active_position[1]--;break;case 2:this.active_position[1]<this.stage[1]-1&&this.active_position[1]++;break;case 3:this.active_position[0]>0&&this.active_position[0]--;break;case 4:this.active_position[0]<this.stage[0]-1&&this.active_position[0]++;break;case 0:case-1:case-2:case-3:case-4:case-5:this.setBlock(this.active_position[1],this.active_position[0],-a);break;default:break}}}},setBlock:function(t,e,a){if(2==a){var n=this.getstaticmap().indexOf(2);if(n>-1)for(var c in this.static_map)for(var i in this.static_map[c])if(2===this.static_map[c][i]){this.static_map[c][i]=1;break}}this.static_map[t][e]=a},getBlock:function(t){return["stone","back","player","box","dream","complete"][t]}}});a("3c2e");const T=m()(I,[["render",M],["__scopeId","data-v-4e9a0265"]]);var N=T,J={map:[0,0,0,0,0,0,0,2,1,1,1,0,0,1,3,3,1,0,0,1,1,0,0,0,0,1,1,1,4,0,0,1,1,1,4,0,0,0,0,0,0,0],stage:[6,7]},L={data:function(){return{status:"default"}},mixins:[J],name:"App",components:{BoxPusher:O,MapEditor:N},methods:{changestatus:function(t){this.status=t.currentTarget.dataset.key},play:function(t){this.map=t.map,this.stage=t.stage,this.status="default"}}};a("b70d");const V=m()(L,[["render",i]]);var $=V;Object(n["b"])($).mount("#app")},b70d:function(t,e,a){"use strict";a("f736")},d319:function(t,e,a){},f736:function(t,e,a){}});
//# sourceMappingURL=app.9db77b0f.js.map